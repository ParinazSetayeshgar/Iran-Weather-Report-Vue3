<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css" type="text/css">
    <link rel="shortcut icon" href="./assests/thermometer.ico" type="image/x-icon"> 
    <title>Tehran Current Weather</title>
    

</head>
<body>
    <div id="app">

        <header>
            <info :date="date"></info>

            <time :date="date"></time>
        </header>

        <climate></climate>

        <footer>
            Developed By Parinaz Setayeshgar
        </footer>

    </div>
    <script src="https://unpkg.com/vue@next"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
    <script type="text/javascript">

        const app = Vue.createApp({

            data() {

                return {
                    date: null
                }
            },

            mounted() {

                let currentDate = new Date();
                this.date = currentDate.toString().split(" ");

            }

        }).mount('#app');

        app.component('info', {

            props: {

                date: {
                    type: String,
                    required: true
                }

            },

            template: `
                <div class="info">
                    <div class="tehran">Tehran</div>
                    <div class="today">{{ dateOfToday }}</div>
                </div>
            `,

            computed: {

                dateOfToday() {
                    return this.date.slice(4).join(" ");
                }
            }

        });

        app.component('time', {

            props: {

                date: {
                    type: String,
                    required: true
                }

            },

            template: `
                <div class="time">{{ timeHour + ":" + timeMinutes }}</div>
            `,

            computed: {

                timeHour() {
                    return this.date[4].split(":")[0];
                },

                timeMinutes() {
                    return this.date[4].split(":")[1];
                }
            }

        });

        Vue.component('climate', {

            template:`
                <main>
                    <div class="icon">
                            <img :src="iconSource"alt="weather icon">
                    </div>
                    <div class="report">
                        <div class="temperature">{{ temperature }}</div>
                        <div class="weather">{{ weatherDescription }}</div>
                    </div>
                </main>
            `,

            data () {

                return {

                    jsonResponse: null,

                    iconList: {

                        '01d' : "./assests/sun.png",

                        '01n' : "./assests/moon.png",

                        '02d' : "./assests/sun & cloud.png",

                        '02n' : "./assests/moon & cloud.png",
                
                        '03d' : "./assests/clouds.png",

                        '03n' : "./assests/clouds.png",

                        '04d' : "./assests/clouds.png",

                        '04n' : "./assests/clouds.png",

                        '09d' : "./assests/rain.png",

                        '09n' : "./assests/rain.png",

                        '10d' : "./assests/rain.png",

                        '10n' : "./assests/rain.png",

                        '11d' : "./assests/lightning.png",

                        '11n' : "./assests/lightning.png",

                        '13d' : "./assests/snowy.png",

                        '13n' : "./assests/snowy.png",

                        '50d' : "./assests/mist.png"
            
                    }
            
                }

            },

            mounted () {

                axios
                .get('http://api.openweathermap.org/data/2.5/weather?q=Tehran&units=metric&appid=59047e5b5fb99d3b3a17ffa14fe1730d')
                .then(response => this.jsonResponse = response.json());

            },
            
            computed: {
                
                wheatherDescription() {
                    return this.jsonResponse.weather[0].description;
                },

                iconSource() {
                    let icon = this.jsonResponse.weather[0].icon;
                    return this.iconList.icon.source;
                },

                temperature() {
                    return  Math.floor(jsonResponse.main.temp) + "&#176;c";
                }

            }

        });

    </script>
    
</body>
</html>